(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{238:function(e,t,s){Promise.resolve().then(s.bind(s,3566))},3566:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(7437),n=s(2265);let a=(0,n.memo)(function(e){let{task:t,onSelect:s,onComplete:a}=e,[l,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(t.estimated_seconds||60),d=(0,n.useMemo)(()=>({学習:"bg-blue-500",仕事:"bg-green-500",生活:"bg-orange-500",健康:"bg-red-500"}),[]),m=(0,n.useMemo)(()=>({学習:"\uD83D\uDCDA",仕事:"\uD83D\uDCBC",生活:"\uD83C\uDFE0",健康:"\uD83D\uDCAA"}),[]),x=(0,n.useCallback)(()=>{i(!0),o(t.estimated_seconds||60),s(t)},[t,s]),u=(0,n.useCallback)(()=>{let e=(t.estimated_seconds||60)-c;a(t.id,e,{completed:!0,confidence:"high"}),i(!1)},[t.id,t.estimated_seconds,c,a]),h=(0,n.useCallback)(()=>{a(t.id,0,{completed:!1,reason:"skipped"}),i(!1)},[t.id,a]);(0,n.useEffect)(()=>{if(l&&c>0){let e=setInterval(()=>{o(e=>e<=1?(u(),0):e-1)},1e3);return()=>clearInterval(e)}},[l,c,u]);let g=(0,n.useMemo)(()=>{let e=t.estimated_seconds||60;return(e-c)/e*100},[t.estimated_seconds,c]),b=(0,n.useMemo)(()=>{let e=Math.floor(c/60),t=c%60;return"".concat(e,":").concat(t.toString().padStart(2,"0"))},[c]);return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden transition-all duration-300 hover:shadow-md ".concat(l?"ring-2 ring-blue-500":""),children:[(0,r.jsx)("div",{className:"".concat(d[t.category]||"bg-gray-500"," px-4 py-3"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-white text-lg",children:m[t.category]||"\uD83D\uDCDD"}),(0,r.jsx)("span",{className:"text-white font-medium",children:t.category})]}),(0,r.jsxs)("div",{className:"text-white text-sm",children:[t.estimated_seconds,"秒"]})]})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:t.title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:t.description}),l?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:b}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-1000",style:{width:"".concat(g,"%")}})})]}),t.content&&(0,r.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:(0,r.jsx)("div",{className:"text-lg font-medium text-gray-800",children:t.content})}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:u,className:"flex-1 bg-green-500 text-white py-3 rounded-lg font-medium hover:bg-green-600 transition-colors",children:"完了"}),(0,r.jsx)("button",{onClick:h,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-medium hover:bg-gray-400 transition-colors",children:"スキップ"})]})]}):(0,r.jsx)("button",{onClick:x,className:"w-full bg-blue-500 text-white py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"やってみる"})]})]})});class l extends n.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){if(this.state.hasError){var e;return this.props.fallback||(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"予期しないエラーが発生しました"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"アプリケーションでエラーが発生しました"}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"再読み込み"})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}let i=(0,n.memo)(function(e){let{message:t="読み込み中...",size:s="md",className:n=""}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(n),children:[(0,r.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-indigo-600 ".concat({sm:"h-8 w-8",md:"h-12 w-12",lg:"h-16 w-16"}[s])}),t&&(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:t})]})}),c=(0,n.memo)(function(e){let{error:t,onRetry:s,className:a=""}=e,l=(0,n.useCallback)(()=>{s&&s()},[s]);return(0,r.jsxs)("div",{className:"text-center ".concat(a),children:[(0,r.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"エラーが発生しました"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:t}),s&&(0,r.jsx)("button",{onClick:l,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"再試行"})]})});function o(){let{task:e,loading:t,error:s,fetchTodayTask:o,handleTaskSelect:d,handleTaskComplete:m}=function(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),[a,l]=(0,n.useState)(null),i=(0,n.useCallback)(async()=>{try{r(!0),l(null);let e=await fetch("/api/today");if(!e.ok)throw Error("API request failed");let s=await e.json();if(s.task){let e={...s.task,estimated_seconds:60*s.task.estimatedTime||s.task.estimated_seconds||60};t(e)}}catch(e){l(e instanceof Error?e.message:"Unknown error")}finally{r(!1)}},[]),c=(0,n.useCallback)(e=>{console.log("Task selected:",e)},[]),o=(0,n.useCallback)(async(e,t,s)=>{try{(await fetch("/api/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:e,duration_seconds:t,result:s,timestamp:new Date().toISOString()})})).ok&&await i()}catch(e){console.error("Task submission failed:",e),l("タスクの送信に失敗しました")}},[i]);return{task:e,loading:s,error:a,fetchTodayTask:i,handleTaskSelect:c,handleTaskComplete:o}}();return((0,n.useEffect)(()=>{o()},[o]),t)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsx)(i,{message:"今日のタスクを準備中..."})}):s?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",children:(0,r.jsx)(c,{error:s,onRetry:o})}):(0,r.jsx)(l,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("header",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"\uD83D\uDE80 Steppy"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"1分で始める、人生の成長習慣"})]}),e&&(0,r.jsx)("div",{className:"max-w-lg mx-auto",children:(0,r.jsx)(a,{task:e,onSelect:d,onComplete:m})}),(0,r.jsx)("footer",{className:"text-center mt-12 text-gray-500",children:(0,r.jsx)("p",{children:"Engineer Guild Hackathon 2025"})})]})})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=238)}),_N_E=e.O()}]);